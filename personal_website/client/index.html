<!DOCTYPE html>
<html ng-app="app">
	<head>
		<meta charset="utf-8">
		<title>Tommy Oh | Full Stack Developer</title>
		<link rel="icon" type="image/x-icon" href="/static/img/my_face.ico">

		<!-- load jquery -->
		<script type="text/javascript" src="/static/js/jquery.min.js"></script>
		<!-- load bootstrap javascript -->
		<script type="text/javascript" src="/static/js/bootstrap.min.js"></script>
		<!-- load font-awesome js -->
		<!-- <script src="https://use.fontawesome.com/9abc27e70e.js"></script> -->
		<script type="text/javascript" src="/static/js/font-awesome.min.js"></script>
		<!-- load style CSS -->
		<link rel="stylesheet" type="text/css" href="/static/css/bootstrap.min.css">
		<link rel="stylesheet" type="text/css" href="/static/css/bootstrap-social.css">
		<link rel="stylesheet" type="text/css" href="/static/css/style.css">

		<!-- load angularJS and its dependencies -->
		<script type="text/javascript" src="/static/js/angular.min.js"></script>
		<script type="text/javascript" src="/static/js/angular-route.min.js"></script>
		<script type="text/javascript" src="/static/js/angular-cookies.min.js"></script>
		<script type="text/javascript" src="/static/js/angular-flash.min.js"></script>

		<!-- load angular.module and config -->
		<!-- load factories: usersFactory, topicsFactory -->
		<!-- load controllers: UserController, DashboardController, TopicController, ProfileController -->

		<script type="text/javascript">
			var app = angular.module("app", ['ngRoute', 'ngCookies', 'ngFlash']);

			app.config(['$routeProvider', function($routeProvider) {
				$routeProvider
					.when('/home', {
						templateUrl: "static/partials/home.html"
					})
					.when('/me', {
						templateUrl: "static/partials/me.html",
						controller: 'MeController'
					})
					.when('/resume', {
						templateUrl: "static/partials/resume.html"
					})
					.when('/contact', {
						templateUrl: "static/partials/contact.html",
						controller: 'ContactController'
					})
					.when('/skills', {
						templateUrl: "static/partials/skill_storage.html"
					})
					.when('/self', {
						templateUrl: "static/partials/self_qa.html"
					})
					.when('/daily', {
						templateUrl: "static/partials/daily_plan.html"
					})
					.otherwise({
						redirectTo: '/home'
					});
			}]);

			app.factory("contactsFactory", ['$http', function($http) {

				function ContactsFactory() {

					this.send_email = function(newMessage, callback) {
						console.log(newMessage);
						$http.post('/contact/email', newMessage).then(
							function success(response) {
								// if there is an error key, send the error.
								if (typeof(response.data.error) != 'undefined') {
									callback(false, response.data.error);
								}
								else {
									// else send back the success message
									callback(true, response.data.success);
								}
							},
							function error(response) {
								console.log("[send_email: ERROR] the server has failed to send email to Tommy!");
							}
						);
					}


				}


				return new ContactsFactory;
			}]);

			app.controller("ContactController", ['$scope', '$location', '$cookies', 'contactsFactory', 'Flash', function($scope, $location, $cookies, contactsFactory, Flash) {

				$scope.send_email = function() {
					contactsFactory.send_email($scope.newMessage, function(status, response) {
						if (status == false) {
							// show flash message for error
							Flash.create('danger', response);
						}
						else {
							$scope.newMessage = {}; // clear the contact form
							// show flash message for confirmation
							Flash.create('success', response);
						}
					});
				}

			}]);

			app.controller('MeController', ['$scope', function($scope) {

				$scope.showMeaning = false;
				$scope.hoverInCerca = function() {
					$scope.showMeaning = true;
					$scope.stylePhoto = {
						'border': '8px groove rgba(255, 202, 81, 0.7)',
					};
				}

				$scope.hoverOutMeaning = function() {
					$scope.showMeaning = false;
					$scope.stylePhoto = {};
				}
			}]);

		</script>
	</head>
	<body>
		<div ng-view="">
			<!-- partials to be loaded in this div. -->
		</div>

		<!-- FOOTER -->
		<footer class="footer">
			<div class="container text-center">
				<p class="text-muted">
					<small>&copy; 2016 By Tommy Oh &middot;</small>
					<a target="_blank" href="https://github.com/fobbytommy" class="btn btn-social-icon btn-github btn-xs">
						<i class="fa fa-github" aria-hidden="true"></i>
					</a> <small>&middot;</small>
					<a target="_blank" href="https://www.linkedin.com/in/tommy-oh" class="btn btn-social-icon btn-linkedin btn-xs">
						<i class="fa fa-linkedin" aria-hidden="true"></i>
					</a>
				</p>
			</div>
		</footer>
	</body>
</html>
